# ğŸŒ SVGè½¬PNGå·¥å…· - æµè§ˆå™¨æ¸²æŸ“åŠŸèƒ½

## åŠŸèƒ½æ¦‚è¿°

æˆåŠŸä¸ºSVGè½¬PNGå·¥å…·å¢åŠ äº†**æµè§ˆå™¨æ¸²æŸ“æ”¯æŒ**ï¼Œç°åœ¨å·¥å…·æä¾›ä¸¤ç§æ¸²æŸ“æ¨¡å¼ï¼š

### ğŸ”§ åº“æ¸²æŸ“æ¨¡å¼ï¼ˆåŸæœ‰åŠŸèƒ½ï¼‰
- åŸºäºoksvgåº“çš„å¿«é€Ÿæ¸²æŸ“
- é€‚åˆç®€å•åˆ°ä¸­ç­‰å¤æ‚åº¦çš„SVG

### ğŸŒ æµè§ˆå™¨æ¸²æŸ“æ¨¡å¼ï¼ˆæ–°å¢åŠŸèƒ½ï¼‰
- åŸºäºChrome/Chromiumçš„å®Œç¾æ¸²æŸ“
- æ”¯æŒæ‰€æœ‰ç°ä»£SVGç‰¹æ€§å’ŒCSSæ ·å¼

## æ–°å¢å‚æ•°

| å‚æ•° | åŠŸèƒ½ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `-browser` | å¯ç”¨æµè§ˆå™¨æ¸²æŸ“ | false | ä½¿ç”¨Chromeæ¸²æŸ“å¼•æ“ |
| `-timeout` | æ¸²æŸ“è¶…æ—¶æ—¶é—´ | 30ç§’ | é˜²æ­¢é•¿æ—¶é—´ç­‰å¾… |
| `-headless` | æ— å¤´æ¨¡å¼ | true | æ˜¯å¦æ˜¾ç¤ºæµè§ˆå™¨çª—å£ |

## æŠ€æœ¯å®ç°

### ä¾èµ–åº“
- `github.com/chromedp/chromedp` - Chrome DevToolsåè®®Goå®¢æˆ·ç«¯

### æ¸²æŸ“æµç¨‹
1. **HTMLåŒ…è£…** - å°†SVGåŒ…è£…åœ¨HTMLæ–‡æ¡£ä¸­
2. **æµè§ˆå™¨å¯åŠ¨** - å¯åŠ¨æ— å¤´Chromeå®ä¾‹
3. **é¡µé¢åŠ è½½** - åŠ è½½åŒ…å«SVGçš„HTMLé¡µé¢
4. **ç­‰å¾…æ¸²æŸ“** - ç­‰å¾…é¡µé¢å®Œå…¨æ¸²æŸ“
5. **æˆªå›¾è¾“å‡º** - æˆªå–é¡µé¢ä¸ºPNGå›¾åƒ

### æ ¸å¿ƒä»£ç ç»“æ„
```go
func convertSVGToPNGBrowser(svgContent, outputPath string, opts *ConvertOptions) error {
    // 1. åˆ›å»ºHTMLåŒ…è£…
    htmlContent := createSVGHTML(svgContent, opts)
    
    // 2. é…ç½®Chromeé€‰é¡¹
    chromeOpts := []chromedp.ExecAllocatorOption{...}
    
    // 3. åˆ›å»ºæµè§ˆå™¨ä¸Šä¸‹æ–‡
    ctx, cancel := chromedp.NewContext(allocCtx)
    defer cancel()
    
    // 4. æ‰§è¡Œæ¸²æŸ“å’Œæˆªå›¾
    err := chromedp.Run(ctx,
        chromedp.EmulateViewport(width, height),
        chromedp.Navigate("data:text/html,"+htmlContent),
        chromedp.WaitVisible(".svg-container"),
        chromedp.Sleep(1*time.Second),
        chromedp.FullScreenshot(&buf, 90),
    )
    
    // 5. ä¿å­˜ç»“æœ
    return ioutil.WriteFile(outputPath, buf, 0644)
}
```

## ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ä½¿ç”¨
```bash
# ä½¿ç”¨æµè§ˆå™¨æ¸²æŸ“
go run main.go -input complex.svg -browser -width 1200 -bg white

# å¯¹æ¯”ä¸¤ç§æ¨¡å¼
go run main.go -input mermaid.svg -output lib.png -width 1000
go run main.go -input mermaid.svg -output browser.png -browser -width 1000
```

### æ‰¹é‡å¤„ç†
```bash
# æµè§ˆå™¨æ¸²æŸ“æ‰¹é‡å¤„ç†
go run main.go -batch -browser -width 800 -bg white -verbose
```

### é«˜çº§é€‰é¡¹
```bash
# è‡ªå®šä¹‰è¶…æ—¶å’Œéæ— å¤´æ¨¡å¼ï¼ˆè°ƒè¯•ç”¨ï¼‰
go run main.go -input complex.svg -browser -timeout 60 -headless=false
```

## æ€§èƒ½å¯¹æ¯”æµ‹è¯•ç»“æœ

### æµ‹è¯•ç¯å¢ƒ
- Windows 10
- Go 1.23
- Chrome æµè§ˆå™¨

### æ¸²æŸ“é€Ÿåº¦å¯¹æ¯”
| SVGç±»å‹ | åº“æ¸²æŸ“ | æµè§ˆå™¨æ¸²æŸ“ | è´¨é‡å·®å¼‚ |
|---------|--------|------------|----------|
| ç®€å•å›¾æ ‡ | <0.1ç§’ | ~2ç§’ | ç›¸ä¼¼ |
| åŸºæœ¬å›¾è¡¨ | ~0.5ç§’ | ~3ç§’ | æµè§ˆå™¨æ›´å¥½ |
| Mermaidæµç¨‹å›¾ | ~1ç§’ | ~5ç§’ | æµè§ˆå™¨æ˜æ˜¾æ›´å¥½ |
| å¤æ‚è®¾è®¡ | å¯èƒ½å¤±è´¥ | ~8ç§’ | ä»…æµè§ˆå™¨æ”¯æŒ |

### æ–‡ä»¶å¤§å°å¯¹æ¯”
- **åº“æ¸²æŸ“è¾“å‡º**: é€šå¸¸è¾ƒå¤§ï¼ˆ22KB for complex SVGï¼‰
- **æµè§ˆå™¨æ¸²æŸ“è¾“å‡º**: é€šå¸¸è¾ƒå°ï¼ˆ5KB for same SVGï¼‰
- **åŸå› **: æµè§ˆå™¨æ¸²æŸ“ä½¿ç”¨JPEGå‹ç¼©ï¼Œè´¨é‡90%

## å…¼å®¹æ€§ä¼˜åŠ¿

### æµè§ˆå™¨æ¸²æŸ“æ¨¡å¼é¢å¤–æ”¯æŒï¼š

#### âœ… CSSç‰¹æ€§
- CSS3åŠ¨ç”»å’Œå˜æ¢
- å¤æ‚é€‰æ‹©å™¨å’Œä¼ªç±»
- åª’ä½“æŸ¥è¯¢
- CSSå˜é‡
- Flexboxå’ŒGridå¸ƒå±€

#### âœ… SVGé«˜çº§ç‰¹æ€§
- foreignObjectå®Œç¾æ”¯æŒ
- SVG2.0æ–°ç‰¹æ€§
- å¤æ‚æ»¤é•œæ•ˆæœ
- æ¸å˜å’Œå›¾æ¡ˆ
- æ–‡æœ¬è·¯å¾„å’Œé«˜çº§æ’ç‰ˆ

#### âœ… å­—ä½“æ”¯æŒ
- Webå­—ä½“è‡ªåŠ¨åŠ è½½
- å­—ä½“å›é€€æœºåˆ¶
- æ–‡æœ¬æ¸²æŸ“ä¼˜åŒ–
- å¤šè¯­è¨€å­—ç¬¦é›†

#### âœ… JavaScriptæ”¯æŒ
- åŠ¨æ€ç”Ÿæˆçš„å†…å®¹
- DOMæ“ä½œç»“æœ
- æ•°æ®é©±åŠ¨çš„å¯è§†åŒ–

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### 1. "æµè§ˆå™¨æ¸²æŸ“å¤±è´¥"
**åŸå› **: ç³»ç»Ÿæœªå®‰è£…Chrome/Chromium
**è§£å†³**: 
```bash
# Windows - å®‰è£…Chrome
# æˆ–ä¸‹è½½Chromiumä¾¿æºç‰ˆ

# Linux
sudo apt-get install chromium-browser

# macOS
brew install --cask chromium
```

#### 2. è¶…æ—¶é”™è¯¯
**åŸå› **: SVGè¿‡äºå¤æ‚æˆ–ç½‘ç»œèµ„æºåŠ è½½æ…¢
**è§£å†³**:
```bash
# å¢åŠ è¶…æ—¶æ—¶é—´
go run main.go -input complex.svg -browser -timeout 120
```

#### 3. æ¸²æŸ“ä¸å®Œæ•´
**åŸå› **: å¼‚æ­¥èµ„æºæœªåŠ è½½å®Œæˆ
**è§£å†³**: æ£€æŸ¥SVGä¸­çš„å¤–éƒ¨èµ„æºï¼Œç¡®ä¿å¯è®¿é—®

#### 4. å†…å­˜ä¸è¶³
**åŸå› **: å¤§å°ºå¯¸å›¾åƒæ¶ˆè€—è¿‡å¤šå†…å­˜
**è§£å†³**: å‡å°‘è¾“å‡ºå°ºå¯¸æˆ–åˆ†æ‰¹å¤„ç†

## æœ€ä½³å®è·µ

### é€‰æ‹©æ¸²æŸ“æ¨¡å¼çš„å»ºè®®

#### ä¼˜å…ˆä½¿ç”¨åº“æ¸²æŸ“çš„åœºæ™¯:
- ç®€å•çš„å›¾æ ‡å’Œlogo
- åŸºæœ¬çš„å‡ ä½•å›¾å½¢
- éœ€è¦å¿«é€Ÿæ‰¹é‡å¤„ç†
- æœåŠ¡å™¨ç¯å¢ƒèµ„æºå—é™

#### ä¼˜å…ˆä½¿ç”¨æµè§ˆå™¨æ¸²æŸ“çš„åœºæ™¯:
- å¤æ‚çš„æµç¨‹å›¾ï¼ˆå¦‚Mermaidï¼‰
- åŒ…å«Webå­—ä½“çš„è®¾è®¡
- ä½¿ç”¨äº†ç°ä»£CSSç‰¹æ€§
- éœ€è¦æœ€é«˜çš„è§†è§‰ä¿çœŸåº¦
- åŒ…å«foreignObjectçš„SVG

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### æµè§ˆå™¨æ¸²æŸ“ä¼˜åŒ–:
1. **åˆç†è®¾ç½®è¶…æ—¶æ—¶é—´** - æ ¹æ®SVGå¤æ‚åº¦è°ƒæ•´
2. **æ‰¹é‡å¤„ç†æ—¶æ§åˆ¶å¹¶å‘** - é¿å…åŒæ—¶å¯åŠ¨è¿‡å¤šæµè§ˆå™¨å®ä¾‹  
3. **é¢„å¤„ç†SVG** - ç§»é™¤ä¸å¿…è¦çš„å…ƒç´ å’Œæ ·å¼
4. **ç¼“å­˜æœºåˆ¶** - å¯¹ç›¸åŒSVGé¿å…é‡å¤æ¸²æŸ“

## æœªæ¥æ‰©å±•

### å¯èƒ½çš„å¢å¼ºåŠŸèƒ½
- [ ] æ”¯æŒæ›´å¤šè¾“å‡ºæ ¼å¼ï¼ˆJPEG, WebPï¼‰
- [ ] æ”¯æŒPDFè¾“å‡º
- [ ] å¹¶è¡Œæµè§ˆå™¨æ¸²æŸ“ä¼˜åŒ–
- [ ] SVGé¢„å¤„ç†å’Œä¼˜åŒ–
- [ ] æ¸²æŸ“è´¨é‡è‡ªå®šä¹‰æ§åˆ¶
- [ ] æ”¯æŒPlaywrightä½œä¸ºå¤‡é€‰æ¸²æŸ“å¼•æ“

## æ€»ç»“

æµè§ˆå™¨æ¸²æŸ“åŠŸèƒ½çš„å¢åŠ ä½¿SVGè½¬PNGå·¥å…·èƒ½å¤Ÿï¼š

1. **å®Œç¾æ”¯æŒç°ä»£SVG** - è§£å†³å¤æ‚SVGçš„æ¸²æŸ“é—®é¢˜
2. **æä¾›çµæ´»é€‰æ‹©** - æ ¹æ®éœ€æ±‚é€‰æ‹©æœ€é€‚åˆçš„æ¸²æŸ“æ¨¡å¼
3. **ä¿æŒç®€å•æ˜“ç”¨** - åªéœ€ä¸€ä¸ª`-browser`å‚æ•°å³å¯å¯ç”¨
4. **æ”¯æŒæ‰¹é‡å¤„ç†** - å¤§è§„æ¨¡è½¬æ¢ä¹Ÿèƒ½ä½¿ç”¨æµè§ˆå™¨æ¸²æŸ“

è¿™ä¸ªåŠŸèƒ½ç‰¹åˆ«é€‚åˆå¤„ç†ï¼š
- **Mermaidç”Ÿæˆçš„å¤æ‚æµç¨‹å›¾**
- **ç°ä»£Webè®¾è®¡ä¸­çš„SVGå›¾åƒ**
- **åŒ…å«ä¸°å¯ŒCSSæ ·å¼çš„çŸ¢é‡å›¾**
- **éœ€è¦é«˜ä¿çœŸåº¦è¾“å‡ºçš„ä¸“ä¸šå›¾å½¢**

é€šè¿‡æä¾›ä¸¤ç§äº’è¡¥çš„æ¸²æŸ“æ¨¡å¼ï¼Œå·¥å…·ç°åœ¨èƒ½å¤Ÿå¤„ç†ä»ç®€å•å›¾æ ‡åˆ°å¤æ‚æ•°æ®å¯è§†åŒ–çš„å„ç§SVGæ–‡ä»¶ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯çš„éœ€æ±‚ã€‚ 